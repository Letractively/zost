SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';

DROP SCHEMA IF EXISTS `GYMWORKS` ;
CREATE SCHEMA IF NOT EXISTS `GYMWORKS` DEFAULT CHARACTER SET utf8 ;
USE `GYMWORKS` ;

-- -----------------------------------------------------
-- Table `CLIENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `CLIENTES` ;

CREATE  TABLE IF NOT EXISTS `CLIENTES` (
  `SM_CLIENTES_ID` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `SM_TITULAR_ID` SMALLINT UNSIGNED NULL DEFAULT NULL ,
  `VA_NOME` VARCHAR(64) NOT NULL ,
  `CH_CPF` CHAR(11) NULL DEFAULT NULL ,
  `CH_CNPJ` CHAR(14) NULL DEFAULT NULL ,
  `VA_RG` VARCHAR(10) NOT NULL ,
  `VA_OERG` ENUM('PM','PC','SSP','SDS','MMA','MAE','MEX','ZZZ') NOT NULL DEFAULT 'SSP' ,
  `CH_UFRG` ENUM('AC','AL','AP','AM','BA','CE','DF','ES','GO','MA','MT','MS','MG','PA','PB','PR','PE','PI','RJ','RN','RS','RO','RR','SC','SP','SE','TO') NOT NULL DEFAULT 'PE' ,
  PRIMARY KEY (`SM_CLIENTES_ID`) ,
  CONSTRAINT `CLI_CLI_FK`
    FOREIGN KEY (`SM_TITULAR_ID` )
    REFERENCES `CLIENTES` (`SM_CLIENTES_ID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB
COMMENT = 'CLI' ;

CREATE INDEX `CLI_CLI_IX` ON `CLIENTES` (`SM_TITULAR_ID` ASC) ;


-- -----------------------------------------------------
-- Table `TELEFONESDOSCLIENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TELEFONESDOSCLIENTES` ;

CREATE  TABLE IF NOT EXISTS `TELEFONESDOSCLIENTES` (
  `SM_TELEFONESDOSCLIENTES_ID` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `SM_CLIENTES_ID` SMALLINT UNSIGNED NOT NULL ,
  `CH_TELEFONE` CHAR(10) NOT NULL ,
  `EN_TIPO` ENUM('RESIDENCIAL','CELULAR','COMERCIAL') NOT NULL ,
  `BO_PRIMARIO` TINYINT(1)  NULL DEFAULT FALSE ,
  PRIMARY KEY (`SM_TELEFONESDOSCLIENTES_ID`) ,
  CONSTRAINT `TDC_CLI_FK`
    FOREIGN KEY (`SM_CLIENTES_ID` )
    REFERENCES `CLIENTES` (`SM_CLIENTES_ID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB, 
COMMENT = 'TDC' ;

CREATE INDEX `TDC_CLI_IX` ON `TELEFONESDOSCLIENTES` (`SM_CLIENTES_ID` ASC) ;


-- -----------------------------------------------------
-- Table `EMAILSDOSCLIENTES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `EMAILSDOSCLIENTES` ;

CREATE  TABLE IF NOT EXISTS `EMAILSDOSCLIENTES` (
  `SM_EMAILSDOSCLIENTES_ID` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `SM_CLIENTES_ID` SMALLINT UNSIGNED NOT NULL ,
  `VA_EMAIL` VARCHAR(64) NOT NULL ,
  `BO_PRIMARIO` TINYINT(1)  NULL DEFAULT FALSE ,
  PRIMARY KEY (`SM_EMAILSDOSCLIENTES_ID`) ,
  CONSTRAINT `EDC_CLI_FK`
    FOREIGN KEY (`SM_CLIENTES_ID` )
    REFERENCES `CLIENTES` (`SM_CLIENTES_ID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB, 
COMMENT = 'EDC' ;

CREATE INDEX `EDC_CLI_IX` ON `EMAILSDOSCLIENTES` (`SM_CLIENTES_ID` ASC) ;


-- -----------------------------------------------------
-- Table `PERFIS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PERFIS` ;

CREATE  TABLE IF NOT EXISTS `PERFIS` (
  `TI_PERFIS_ID` TINYINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `VA_NOME` VARCHAR(64) NOT NULL ,
  `VA_DESCRICAO` VARCHAR(128) NOT NULL ,
  PRIMARY KEY (`TI_PERFIS_ID`) )
ENGINE = InnoDB, 
COMMENT = 'PER' ;

CREATE UNIQUE INDEX `GRU_VA_NOME_UI` ON `PERFIS` (`VA_NOME` ASC) ;

CREATE UNIQUE INDEX `GRU_VA_DESCRICAO_UI` ON `PERFIS` (`VA_DESCRICAO` ASC) ;


-- -----------------------------------------------------
-- Table `USUARIOS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `USUARIOS` ;

CREATE  TABLE IF NOT EXISTS `USUARIOS` (
  `SM_USUARIOS_ID` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `TI_PERFIS_ID` TINYINT UNSIGNED NULL DEFAULT NULL ,
  `VA_NOME` VARCHAR(64) NOT NULL ,
  `VA_LOGIN` VARCHAR(16) NOT NULL ,
  `CH_SENHA` CHAR(32) NOT NULL ,
  `VA_EMAIL` VARCHAR(64) NULL DEFAULT NULL ,
  PRIMARY KEY (`SM_USUARIOS_ID`) ,
  CONSTRAINT `USU_PER_FK`
    FOREIGN KEY (`TI_PERFIS_ID` )
    REFERENCES `PERFIS` (`TI_PERFIS_ID` )
    ON DELETE SET NULL
    ON UPDATE CASCADE)
ENGINE = InnoDB, 
COMMENT = 'USU' ;

CREATE UNIQUE INDEX `USU_VA_LOGIN_UI` ON `USUARIOS` (`VA_LOGIN` ASC) ;

CREATE UNIQUE INDEX `USU_VA_EMAIL_UI` ON `USUARIOS` (`VA_EMAIL` ASC) ;

CREATE INDEX `USU_PER_IX` ON `USUARIOS` (`TI_PERFIS_ID` ASC) ;


-- -----------------------------------------------------
-- Table `ENTIDADESDOSISTEMA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `ENTIDADESDOSISTEMA` ;

CREATE  TABLE IF NOT EXISTS `ENTIDADESDOSISTEMA` (
  `IN_ENTIDADESDOSISTEMA_ID` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `VA_NOME` VARCHAR(128) NOT NULL ,
  `TI_TIPO` TINYINT(1) UNSIGNED NOT NULL ,
  PRIMARY KEY (`IN_ENTIDADESDOSISTEMA_ID`) )
ENGINE = InnoDB, 
COMMENT = 'EDS' ;

CREATE UNIQUE INDEX `EDS_VA_NOME_UI` ON `ENTIDADESDOSISTEMA` (`VA_NOME` ASC) ;


-- -----------------------------------------------------
-- Table `PERMISSOES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PERMISSOES` ;

CREATE  TABLE IF NOT EXISTS `PERMISSOES` (
  `IN_PERMISSOES_ID` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `TI_LER` TINYINT(1)  NOT NULL DEFAULT FALSE ,
  `TI_INSERIR` TINYINT(1)  NOT NULL DEFAULT FALSE ,
  `TI_ALTERAR` TINYINT(1)  NOT NULL DEFAULT FALSE ,
  `TI_EXCLUIR` TINYINT(1)  NOT NULL DEFAULT FALSE ,
  PRIMARY KEY (`IN_PERMISSOES_ID`) )
ENGINE = InnoDB, 
COMMENT = 'PER' ;



SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `PERFIS`
-- -----------------------------------------------------
START TRANSACTION;
USE `GYMWORKS`;
INSERT INTO PERFIS (`TI_PERFIS_ID`, `VA_NOME`, `VA_DESCRICAO`) VALUES (1, 'Administrador', 'Tem permissão completa e irrestrita a todos os recursos do programa');
INSERT INTO PERFIS (`TI_PERFIS_ID`, `VA_NOME`, `VA_DESCRICAO`) VALUES (2, 'Gerente', 'Tem um conjunto de permissões específicas para garantir o uso de alguns recursos do sistema');
INSERT INTO PERFIS (`TI_PERFIS_ID`, `VA_NOME`, `VA_DESCRICAO`) VALUES (3, 'Usuário', 'Tem um conjunto de permissões limitado');

COMMIT;

-- -----------------------------------------------------
-- Data for table `USUARIOS`
-- -----------------------------------------------------
START TRANSACTION;
USE `GYMWORKS`;
INSERT INTO USUARIOS (`SM_USUARIOS_ID`, `TI_PERFIS_ID`, `VA_NOME`, `VA_LOGIN`, `CH_SENHA`, `VA_EMAIL`) VALUES (1, 1, 'Honorável Administrador do Sistema', 'admin', '202cb962ac59075b964b07152d234b70', NULL);
INSERT INTO USUARIOS (`SM_USUARIOS_ID`, `TI_PERFIS_ID`, `VA_NOME`, `VA_LOGIN`, `CH_SENHA`, `VA_EMAIL`) VALUES (2, 2, 'Carlos Barreto Feitoza Filho', 'cbff', '202cb962ac59075b964b07152d234b70', 'carlos.b.feitoza.filho@gmail.com');

COMMIT;
